<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>PythonåŸºäºæ·˜å®ç”¨æˆ·è¡Œä¸ºåˆ†æ | ç‹å®‰çªçš„æ•°æ®åˆ†æé¡¹ç›®</title>
<link rel="shortcut icon" href="https://Angie-DA.github.io/favicon.ico?v=1647760265899">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://Angie-DA.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="PythonåŸºäºæ·˜å®ç”¨æˆ·è¡Œä¸ºåˆ†æ | ç‹å®‰çªçš„æ•°æ®åˆ†æé¡¹ç›® - Atom Feed" href="https://Angie-DA.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="è°ƒç”¨åŒ…
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import json
import matp..." />
    <meta name="keywords" content="" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://Angie-DA.github.io">
  <img class="avatar" src="https://Angie-DA.github.io/images/avatar.png?v=1647760265899" alt="">
  </a>
  <h1 class="site-title">
    ç‹å®‰çªçš„æ•°æ®åˆ†æé¡¹ç›®
  </h1>
  <p class="site-description">
    åˆçº§DAï¼Œè¯·å¤šå¤šæŒ‡æ•™ğŸ˜†ğŸ˜†
  </p>
  <div class="menu-container">
    
      
        <a href="https://Angie-DA.github.io" class="menu">
          ä¸»é¡µ
        </a>
      
    
      
        <a href="https://Angie-DA.github.io/archives" class="menu">
          æ–‡ç« 
        </a>
      
    
      
        <a href="https://Angie-DA.github.io/tags" class="menu">
          æ ‡ç­¾
        </a>
      
    
  </div>
  <div class="social-container">
    
      
        <a href="https://github.com/xuyj1111" target="_blank">
          <i class="ri-github-line"></i>
        </a>
      
    
      
    
      
    
      
    
      
    
  </div>
  <form id="gridea-search-form" action="https://Angie-DA.github.io/search/">
    <input name="q" />
  </form>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              PythonåŸºäºæ·˜å®ç”¨æˆ·è¡Œä¸ºåˆ†æ
            </h2>
            <div class="post-info">
              <span>
                2022-03-20
              </span>
              <span>
                25 min read
              </span>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <p>è°ƒç”¨åŒ…</p>
<pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import json
import matplotlib


from pyecharts.globals import CurrentConfig, NotebookType
from pyecharts import options as opts


from pyecharts.charts import *
from pyecharts.globals import ThemeType

CurrentConfig.NOTEBOOK_TYPE = NotebookType.JUPYTER_NOTEBOOK
</code></pre>
<h3 id="æ•°æ®è¯»å–">æ•°æ®è¯»å–</h3>
<pre><code class="language-python"># æ•°æ®é‡è¿‡å¤§ï¼Œè¿™é‡Œåªé€‰å–å‰100wè¡Œ
# æ ¹æ®å®˜ç½‘ä»‹ç»ç»™å®šåˆ—å,å…·æœ‰å¯è¯»æ€§

columns=[&quot;userid&quot;, 'itemid', 'categoryid', 'type', 'timestamp']
data = pd.read_csv('E:/UserBehavior.csv',
                   engine='python',
                   encoding='utf-8',
                   names=columns,
                   chunksize=1000000,
                   iterator=True)

plt.rcParams['font.sans-serif'] = 'SimHei'
# plt.rcParams['axes.unicode_minus'] = False
# plt.style.use('ggplot')
</code></pre>
<pre><code class="language-python">dataframe = data.get_chunk(1000000)
</code></pre>
<h4 id="æŸ¥çœ‹æ•°æ®çš„åŸºæœ¬ä¿¡æ¯">æŸ¥çœ‹æ•°æ®çš„åŸºæœ¬ä¿¡æ¯</h4>
<pre><code class="language-python">dataframe.info()
</code></pre>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1000000 entries, 0 to 999999
Data columns (total 5 columns):
 #   Column      Non-Null Count    Dtype 
---  ------      --------------    ----- 
 0   userid      1000000 non-null  int64 
 1   itemid      1000000 non-null  int64 
 2   categoryid  1000000 non-null  int64 
 3   type        1000000 non-null  object
 4   timestamp   1000000 non-null  int64 
dtypes: int64(4), object(1)
memory usage: 38.1+ MB
</code></pre>
<h3 id="æ•°æ®æ¸…æ´—">æ•°æ®æ¸…æ´—</h3>
<pre><code class="language-python">dataframe.isnull().sum()
</code></pre>
<pre><code>userid        0
itemid        0
categoryid    0
type          0
timestamp     0
dtype: int64
</code></pre>
<h4 id="æŸ¥çœ‹æ•°æ®æ²¡æœ‰ç©ºå€¼çš„æ•°æ®çš„ä¸ªæ•°">æŸ¥çœ‹æ•°æ®æ²¡æœ‰ç©ºå€¼çš„æ•°æ®çš„ä¸ªæ•°</h4>
<pre><code class="language-python">dataframe.nunique()
</code></pre>
<pre><code>userid          9739
itemid        399114
categoryid      5796
type               4
timestamp     499049
dtype: int64
</code></pre>
<h4 id="æŸ¥çœ‹æ•°æ®çš„å‰næ¡">æŸ¥çœ‹æ•°æ®çš„å‰næ¡</h4>
<pre><code class="language-python">dataframe.head(n=11)
</code></pre>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userid</th>
      <th>itemid</th>
      <th>categoryid</th>
      <th>type</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2268318</td>
      <td>2520377</td>
      <td>pv</td>
      <td>1511544070</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2333346</td>
      <td>2520771</td>
      <td>pv</td>
      <td>1511561733</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>2576651</td>
      <td>149192</td>
      <td>pv</td>
      <td>1511572885</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3830808</td>
      <td>4181361</td>
      <td>pv</td>
      <td>1511593493</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>4365585</td>
      <td>2520377</td>
      <td>pv</td>
      <td>1511596146</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>4606018</td>
      <td>2735466</td>
      <td>pv</td>
      <td>1511616481</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>230380</td>
      <td>411153</td>
      <td>pv</td>
      <td>1511644942</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1</td>
      <td>3827899</td>
      <td>2920476</td>
      <td>pv</td>
      <td>1511713473</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1</td>
      <td>3745169</td>
      <td>2891509</td>
      <td>pv</td>
      <td>1511725471</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>1531036</td>
      <td>2920476</td>
      <td>pv</td>
      <td>1511733732</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1</td>
      <td>2266567</td>
      <td>4145813</td>
      <td>pv</td>
      <td>1511741471</td>
    </tr>
  </tbody>
</table>
<h4 id="è½¬æ¢ç±»å‹-æˆªå–æ•°æ®-é‡æ–°æ’åˆ—">è½¬æ¢ç±»å‹ã€æˆªå–æ•°æ®ã€é‡æ–°æ’åˆ—</h4>
<pre><code class="language-python"># åˆ é™¤é‡å¤å€¼ï¼Œç»“æœä¸€æ ·æ•°æ®æ— é‡å¤æœ‰æ•ˆæ•°æ®
dataframe.drop_duplicates(subset=['userid','itemid','type','timestamp'],keep='first',inplace=True)
dataframe.nunique()
</code></pre>
<pre><code>userid          9739
itemid        399114
categoryid      5796
type               4
timestamp     499049
dtype: int64
</code></pre>
<pre><code class="language-python"># å°†æ—¶é—´æˆ³è½¬ä¸ºæ—¥æœŸï¼Œä»åŸæ•°æ®çš„int64è½¬åŒ–ä¸ºæ—¥æœŸç±»å‹
import datetime

# to_datetimeçš„é»˜è®¤æ—¶åŒºä¸æ˜¯ä¸­å›½éœ€è¦æ”¹æˆåŒ—äº¬æ—¶é—´+8h
dataframe['time'] = pd.to_datetime(dataframe['timestamp'],unit='s')+datetime.timedelta(hours = 8)
dataframe.head(n=5)
dataframe.info()

# åªæˆªå–2017.11.25-2017.12.3æœŸé—´çš„æ•°æ®
startTime = datetime.datetime.strptime(&quot;2017-11-25 00:00:00&quot;,&quot;%Y-%m-%d %H:%M:%S&quot;)
endTime = datetime.datetime.strptime(&quot;2017-12-3 23:59:59&quot;,&quot;%Y-%m-%d %H:%M:%S&quot;)
# print(type(startTime))

dataframe = dataframe[(dataframe.time&gt;=startTime)&amp;(dataframe.time&lt;=endTime)]
# åˆ é™¤åŸç´¢å¼•é‡æ–°æ’åˆ—æ–°çš„ç´¢å¼•
dataframe = dataframe.reset_index(drop=True)

# æ‹†åˆ†æ—¥æœŸå’Œå°æ—¶
dataframe['date']=dataframe.time.dt.date
dataframe['hour']=dataframe.time.dt.hour

#åˆ é™¤åŸæ•°æ®åˆ—çš„æ—¶é—´æˆ³å±æ€§
dataframe.drop('timestamp',inplace=True, axis=1)
</code></pre>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 1000000 entries, 0 to 999999
Data columns (total 6 columns):
 #   Column      Non-Null Count    Dtype         
---  ------      --------------    -----         
 0   userid      1000000 non-null  int64         
 1   itemid      1000000 non-null  int64         
 2   categoryid  1000000 non-null  int64         
 3   type        1000000 non-null  object        
 4   timestamp   1000000 non-null  int64         
 5   time        1000000 non-null  datetime64[ns]
dtypes: datetime64[ns](1), int64(4), object(1)
memory usage: 53.4+ MB
</code></pre>
<pre><code class="language-python">dataframe.head()
</code></pre>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userid</th>
      <th>itemid</th>
      <th>categoryid</th>
      <th>type</th>
      <th>time</th>
      <th>date</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2268318</td>
      <td>2520377</td>
      <td>pv</td>
      <td>2017-11-25 01:21:10</td>
      <td>2017-11-25</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2333346</td>
      <td>2520771</td>
      <td>pv</td>
      <td>2017-11-25 06:15:33</td>
      <td>2017-11-25</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>2576651</td>
      <td>149192</td>
      <td>pv</td>
      <td>2017-11-25 09:21:25</td>
      <td>2017-11-25</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3830808</td>
      <td>4181361</td>
      <td>pv</td>
      <td>2017-11-25 15:04:53</td>
      <td>2017-11-25</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>4365585</td>
      <td>2520377</td>
      <td>pv</td>
      <td>2017-11-25 15:49:06</td>
      <td>2017-11-25</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
<pre><code class="language-python"># æè¿°æ€§ç»Ÿè®¡æ•°æ®ï¼Œç§‘å­¦è®¡æ•°æ³•è¡¨ç¤º
dataframe.describe()
</code></pre>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userid</th>
      <th>itemid</th>
      <th>categoryid</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>9.995300e+05</td>
      <td>9.995300e+05</td>
      <td>9.995300e+05</td>
      <td>999530.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>4.299721e+05</td>
      <td>2.577625e+06</td>
      <td>2.706119e+06</td>
      <td>14.898745</td>
    </tr>
    <tr>
      <th>std</th>
      <td>4.353251e+05</td>
      <td>1.488870e+06</td>
      <td>1.464049e+06</td>
      <td>6.117604</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000e+00</td>
      <td>7.200000e+01</td>
      <td>2.171000e+03</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.091610e+05</td>
      <td>1.292370e+06</td>
      <td>1.343555e+06</td>
      <td>11.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.216220e+05</td>
      <td>2.575767e+06</td>
      <td>2.693696e+06</td>
      <td>16.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.005419e+06</td>
      <td>3.861783e+06</td>
      <td>4.145813e+06</td>
      <td>20.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.018011e+06</td>
      <td>5.163057e+06</td>
      <td>5.161669e+06</td>
      <td>23.000000</td>
    </tr>
  </tbody>
</table>
<h4 id="æ•°æ®æ¸…æ´—ç»“æœ">æ•°æ®æ¸…æ´—ç»“æœ</h4>
<pre><code class="language-python">print('æ•°æ®æ¸…æ´—åå…±æœ‰{}è¡Œè®°å½•ï¼Œ{}åˆ—å­—æ®µï¼Œå­—æ®µåˆ†åˆ«ä¸º{}'.format(dataframe.shape[0],dataframe.shape[1],dataframe.columns.tolist()))
</code></pre>
<pre><code>æ•°æ®æ¸…æ´—åå…±æœ‰999530è¡Œè®°å½•ï¼Œ7åˆ—å­—æ®µï¼Œå­—æ®µåˆ†åˆ«ä¸º['userid', 'itemid', 'categoryid', 'type', 'time', 'date', 'hour']
</code></pre>
<h3 id="ç”¨æˆ·æ•°æ®åˆ†æ">ç”¨æˆ·æ•°æ®åˆ†æ</h3>
<pre><code class="language-python"># æœ‰æ•ˆæ—¶é—´å†…æ€»ç”¨æˆ·æ•°é‡ï¼Œæœ‰æ“ä½œçš„å•†å“æ•°é‡åŠç±»ç›®
#     ç‹¬ç«‹è®¿å®¢æ•°UV
total_unique_users = dataframe.userid.nunique()
#     æœ‰æ“ä½œçš„å•†å“
total_unique_itemid = dataframe.itemid.nunique()
#     æœ‰æ“ä½œçš„å•†å“ç±»ç›®
total_unique_categoryid = dataframe.categoryid.nunique()
#     ä»˜è´¹ç”¨æˆ·æ•°
user_bought_count = dataframe[dataframe['type']=='buy'].userid.nunique()
#     éä»˜è´¹ç”¨æˆ·æ•°
user_nobought_count = total_unique_users - user_bought_count
</code></pre>
<h4 id="è¾“å‡ºå½“å‰æ•°æ®å„æ ç›®è®¡æ•°">è¾“å‡ºå½“å‰æ•°æ®å„æ ç›®è®¡æ•°</h4>
<pre><code class="language-python">total={'UV':[total_unique_users],'å•†å“æ•°':[total_unique_itemid],'ç±»ç›®æ•°':[total_unique_categoryid],'ä»˜è´¹ç”¨æˆ·æ•°':[user_bought_count],'éä»˜è´¹ç”¨æˆ·æ•°':[user_nobought_count]}
totalnew= pd.DataFrame(total,index = [''])
totalnew
</code></pre>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>UV</th>
      <th>å•†å“æ•°</th>
      <th>ç±»ç›®æ•°</th>
      <th>ä»˜è´¹ç”¨æˆ·æ•°</th>
      <th>éä»˜è´¹ç”¨æˆ·æ•°</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th></th>
      <td>9739</td>
      <td>398971</td>
      <td>5793</td>
      <td>6689</td>
      <td>3050</td>
    </tr>
  </tbody>
</table>
<h4 id="ç”¨æˆ·å¤è´­ç‡">ç”¨æˆ·å¤è´­ç‡</h4>
<p>ç”¨æˆ·å¤è´­ç‡=è´­ä¹°2æ¬¡åŠä»¥ä¸Šç”¨æˆ·æ•°/æ€»è´­ä¹°ç”¨æˆ·æ•°</p>
<pre><code class="language-python">groupby_userid = dataframe.groupby('userid')
user_type = groupby_userid.type.value_counts().unstack()  # ä½¿ç”¨unstackè¿›è¡Œä¸å †å æ“ä½œï¼Œåˆ—æ–¹å‘ä¸Šçš„ç´¢å¼•è½¬æˆè¡Œæ–¹å‘çš„ç´¢å¼•
user_type.tail()
</code></pre>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>type</th>
      <th>buy</th>
      <th>cart</th>
      <th>fav</th>
      <th>pv</th>
    </tr>
    <tr>
      <th>userid</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1017990</th>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>56.0</td>
    </tr>
    <tr>
      <th>1017994</th>
      <td>NaN</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>1017997</th>
      <td>2.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>1018000</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>181.0</td>
    </tr>
    <tr>
      <th>1018011</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>41.0</td>
    </tr>
  </tbody>
</table>
<h4 id="å¯è§†åŒ–å›¾è¡¨">å¯è§†åŒ–å›¾è¡¨</h4>
<pre><code class="language-python"># æå–æ•°æ®
type_series = dataframe.type.value_counts()
</code></pre>
<h5 id="é¥¼å›¾-ç”¨æˆ·è¡Œä¸ºå æ¯”">é¥¼å›¾-ç”¨æˆ·è¡Œä¸ºå æ¯”</h5>
<pre><code class="language-python">plt.figure(figsize = (5,5), dpi = 100)
plt.pie(type_series,
        labels=type_series.index,
        autopct='%1.2f%%', 
        pctdistance = 0.8, 
        counterclock = False, 
        wedgeprops = {'width':0.4})
plt.title('ç”¨æˆ·è¡Œä¸ºå æ¯”')
plt.show()
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://Angie-DA.github.io/post-images/1647759783333.png" alt="" loading="lazy"></figure>
<h5 id="åŠ¨æ€æ›²çº¿-æ¯æ—¥pv-uv">åŠ¨æ€æ›²çº¿-æ¯æ—¥pvã€uv</h5>
<pre><code class="language-python">#æå–æ•°æ®
pv_day = dataframe[dataframe.type =='pv'].groupby('date')['type'].count()
uv_day = dataframe[dataframe.type =='pv'].drop_duplicates(['userid','date']).groupby('date')['userid'].count()
#è½¬æ¢æˆå›¾è¡¨æ‰€éœ€çš„æ ¼å¼ï¼ˆlistï¼‰
#1ã€æ—¥æœŸï¼ˆlist.indexï¼‰
date = pv_day.index
#2ã€pvã€uvï¼ˆlist.valuesï¼‰
pv = np.around(pv_day.values/10000,decimals=2)
# uv = np.around(uv_day.values,decimals=2)
uv=uv_day
</code></pre>
<pre><code class="language-python"># åˆ¶ä½œæ›²çº¿å›¾è¡¨
x=list(date)
y1=pv
y2=uv
pvuv_day_line = (Line(init_opts=opts.InitOpts(theme=ThemeType.DARK)) #ä¸»é¢˜è®¾ç½®
       .add_xaxis(x) #xè½´æ•°æ®æº
       .add_yaxis('pv',#å›¾ä¾‹åå­—
                  y1, #y1è½´æ•°æ®æº
                  label_opts=opts.LabelOpts(is_show=False), #ä¸æ˜¾ç¤ºæ•°æ®æ ‡ç­¾
                 )
       .add_yaxis('uv',#å›¾ä¾‹åå­—
                  yaxis_index=1, #Yçš„åŒè½´1å·ç´¢å¼•ï¼ˆåŒºåˆ«äºy1è½´ï¼‰
                  y_axis=y2, #y2è½´æ•°æ®æº
                  label_opts=opts.LabelOpts(is_show=False) #ä¸æ˜¾ç¤ºæ•°æ®æ ‡ç­¾
                 ) 
        .extend_axis( #y2çš„è½´è®¾ç½® 
                    yaxis=opts.AxisOpts(
                                        name='uv',#è½´åå­—
                                        min_=5000,#è½´èµ·ç‚¹å€¼
                                        max_=15000, #è½´æœ€å¤§å€¼
                                        interval=1000, #è½´åŒºé—´é—´éš”
                                        axislabel_opts=opts.LabelOpts(formatter=&quot;{value} äºº&quot;) #è½´æ•°æ®æ ‡ç­¾æ ¼å¼è®¾ç½®
                                         )
                    )
        .set_global_opts( #å…¨å±€è®¾ç½®
                        tooltip_opts=opts.TooltipOpts(is_show=True,trigger=&quot;axis&quot;,axis_pointer_type='cross'), #éšé¼ æ ‡ä½ç½®æ˜¾ç¤ºxyè½´çš„æ•°æ®ã€èšç„¦å½¢å¼(äº¤å‰)
                        xaxis_opts=opts.AxisOpts(type_='category',axispointer_opts=opts.AxisPointerOpts(is_show=True,type_=&quot;shadow&quot;)),#éšé¼ æ ‡ä½ç½®å‡¸æ˜¾xè½´é•¿æ¡ã€å‡¸æ˜¾å½¢å¼ï¼ˆé˜´å½±ï¼‰
                        yaxis_opts=opts.AxisOpts(name='pv',axislabel_opts=opts.LabelOpts(formatter=&quot;{value} ä¸‡æ¬¡&quot;)),#y1è½´(é»˜è®¤è½´)åå­—ã€è½´æ•°æ®æ ‡ç­¾æ ¼å¼è®¾ç½®
                        title_opts=opts.TitleOpts(title=&quot;æ¯æ—¥pvå’Œuv&quot;) #æ ‡é¢˜        
                         )              
            )
pvuv_day_line.render_notebook() #å±•ç¤ºå›¾è¡¨
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://Angie-DA.github.io/post-images/1647759879704.png" alt="" loading="lazy"></figure>
<h5 id="æ¼æ–—å›¾-ç”¨æˆ·è¡Œä¸º">æ¼æ–—å›¾-ç”¨æˆ·è¡Œä¸º</h5>
<p>ç¬¬ä¸€å±‚ï¼šç”¨æˆ·å…¨éƒ¨è¡Œä¸ºï¼ˆpvã€buyã€cartã€favï¼‰</p>
<p>ç¬¬äºŒå±‚ï¼šæ”¶è—/åŠ è´­è¡Œä¸ºï¼ˆcart/favï¼‰</p>
<p>ç¬¬ä¸‰å±‚ï¼šä»˜è´¹è¡Œä¸ºï¼ˆbuyï¼‰</p>
<p>ç›®çš„ï¼šåˆ†æç”¨æˆ·è¡Œä¸ºçš„è½¬åŒ–ç‡</p>
<p>ç”¨æˆ·å„è¡Œä¸ºæ•°æ®è®¡ç®—æ–¹å¼</p>
<pre><code class="language-python"># æœ‰æ•ˆæ—¥æœŸ9å¤©å†…å„ä¸ªè¡Œä¸ºçš„æ“ä½œæ€»æ•°ï¼Œæ¯æ—¥å¹³å‡æ“ä½œæ•°ï¼Œæ¯æ—¥å¹³å‡æ“ä½œç”¨æˆ·æ•°è®°å½•
type_df=pd.DataFrame([type_series,type_series/9,type_series/total_unique_users],
                     index=['total','avg_day','avg_user'])

# ä»˜è´¹ç”¨æˆ·è¡Œä¸ºè®°å½•
type_df.loc['paying_user']=dataframe[dataframe['userid'].isin(dataframe[dataframe['type']=='buy']['userid'])].type.value_counts()
type_df
</code></pre>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pv</th>
      <th>cart</th>
      <th>fav</th>
      <th>buy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>total</th>
      <td>895636.000000</td>
      <td>55447.000000</td>
      <td>28088.000000</td>
      <td>20359.000000</td>
    </tr>
    <tr>
      <th>avg_day</th>
      <td>99515.111111</td>
      <td>6160.777778</td>
      <td>3120.888889</td>
      <td>2262.111111</td>
    </tr>
    <tr>
      <th>avg_user</th>
      <td>91.963857</td>
      <td>5.693295</td>
      <td>2.884074</td>
      <td>2.090461</td>
    </tr>
    <tr>
      <th>paying_user</th>
      <td>673147.000000</td>
      <td>43072.000000</td>
      <td>20373.000000</td>
      <td>20359.000000</td>
    </tr>
  </tbody>
</table>
<pre><code class="language-python"># æå–typeç”¨æˆ·è¡Œä¸ºåˆ—ä¸­çš„æ¯ä¸€ä¸ªè¡Œä¸ºæ•°æ®
pv_df = dataframe[dataframe['type']=='pv']
buy_df = dataframe[dataframe['type']=='buy']
cart_df = dataframe[dataframe['type']=='cart']
fav_df = dataframe[dataframe['type']=='fav']
</code></pre>
<pre><code class="language-python"># æ–¹å¼1 ç‚¹å‡»-&gt;åŠ è´­-&gt;è´­ä¹°
pv_cart_df = pd.merge(left=pv_df,right=cart_df,how='inner',on=['userid','itemid','categoryid'],suffixes=('_pv','_cart'))
cart_buy_df = pd.merge(left=cart_df,right=buy_df,how='inner',on=['userid','itemid','categoryid'],suffixes=('_cart','_buy'))
count_users_pv_cart = pv_cart_df[pv_cart_df.time_pv &lt; pv_cart_df.time_cart].userid.nunique()
count_users_cart_buy = cart_buy_df[cart_buy_df.time_cart &lt; cart_buy_df.time_buy].userid.nunique()

# æ–¹å¼2 ç‚¹å‡»-&gt;æ”¶è—-&gt;è´­ä¹°
pv_fav_df = pd.merge(left=pv_df,right=fav_df,how='inner',on=['userid','itemid','categoryid'],suffixes=('_pv','_fav'))
fav_buy_df = pd.merge(left=fav_df,right=buy_df,how='inner',on=['userid','itemid','categoryid'],suffixes=('_fav','_buy'))
count_user_pv_fav = pv_fav_df[pv_fav_df.time_pv &lt; pv_fav_df.time_fav].userid.nunique()
count_user_fav_buy = fav_buy_df[fav_buy_df.time_fav &lt; fav_buy_df.time_buy].userid.nunique()


# æ–¹å¼3 ç‚¹å‡»-&gt;è´­ä¹°
pv_beh_buy_df = pd.merge(left=pv_df,right=buy_df,how='inner',on=['userid','itemid','categoryid'],suffixes=('_pv','_buy'))
count_user_pv_beh_buy = pv_beh_buy_df[pv_beh_buy_df.time_pv &lt; pv_beh_buy_df.time_buy].userid.nunique()
count_user_pv_buy = count_user_pv_beh_buy - count_users_cart_buy - count_user_fav_buy


print(count_users_cart_buy)
print(count_user_fav_buy)
print(count_user_pv_buy)
</code></pre>
<pre><code>2263
831
1573
</code></pre>
<pre><code class="language-python">fav_cart_ratio = (count_user_pv_fav+count_users_pv_cart)/total_unique_users
buy_beh_ratio=(count_user_fav_buy+count_users_cart_buy)/total_unique_users
buy_ratio = count_user_pv_buy /total_unique_users

print('æ”¶è—åŠ è´­ç”¨æˆ·è½¬åŒ–ç‡ä¸º:%.2f%%'%(fav_cart_ratio*100))
print('æ”¶è—åŠ è´­-&gt;è´­ä¹°ç”¨æˆ·è½¬åŒ–ç‡ä¸º:%.2f%%'%(buy_beh_ratio*100))
print('æµè§ˆç›´æ¥è´­ä¹°ç”¨æˆ·è½¬åŒ–ç‡ä¸º:%.2f%%'%(buy_ratio*100))
</code></pre>
<pre><code>æ”¶è—åŠ è´­ç”¨æˆ·è½¬åŒ–ç‡ä¸º:58.36%
æ”¶è—åŠ è´­-&gt;è´­ä¹°ç”¨æˆ·è½¬åŒ–ç‡ä¸º:31.77%
æµè§ˆç›´æ¥è´­ä¹°ç”¨æˆ·è½¬åŒ–ç‡ä¸º:16.15%
</code></pre>
<pre><code class="language-python">from pyecharts.charts import Funnel
# æ¼æ–—å›¾datapair
process_data_pair = [(&quot;ç‚¹å‡»é‡&quot;, total_unique_users), 
                     (&quot;æ”¶è—åŠ è´­é‡&quot;, count_user_pv_fav+count_users_pv_cart),
                     (&quot;è´­ä¹°é‡&quot;, count_user_fav_buy+count_users_cart_buy)]
(
    Funnel(init_opts=opts.InitOpts(width='500px', height='400px'))
    .add(&quot;type&quot;, 
         data_pair=process_data_pair, 
         label_opts=opts.LabelOpts(position=&quot;top&quot;),
         gap=2,
         tooltip_opts=opts.TooltipOpts(is_show=True))
    .set_global_opts(title_opts=opts.TitleOpts(title=&quot;ç”¨æˆ·è½¬åŒ–ç‡&quot;, subtitle=&quot;process æµè§ˆ-&gt;æ”¶è—/åŠ è´­-&gt;è´­ä¹°&quot;)) 
).render_notebook() 
</code></pre>
<figure data-type="image" tabindex="3"><img src="https://Angie-DA.github.io/post-images/1647759891955.png" alt="" loading="lazy"></figure>
<pre><code class="language-python">process_data_pair = [(&quot;ç‚¹å‡»é‡&quot;, total_unique_users), 
                     (&quot;è´­ä¹°é‡&quot;, count_user_pv_buy)]
(
    Funnel(init_opts=opts.InitOpts(width='500px', height='400px'))
    .add(&quot;type&quot;, 
         data_pair=process_data_pair, 
         label_opts=opts.LabelOpts(position=&quot;top&quot;),
         gap=2,
         tooltip_opts=opts.TooltipOpts(is_show=True))
    .set_global_opts(title_opts=opts.TitleOpts(title=&quot;ç”¨æˆ·è½¬åŒ–ç‡&quot;, subtitle=&quot;process æµè§ˆ-&gt;è´­ä¹°&quot;)) 
).render_notebook() 
</code></pre>
<figure data-type="image" tabindex="4"><img src="https://Angie-DA.github.io/post-images/1647759904810.png" alt="" loading="lazy"></figure>
<h5 id="æŸ±çŠ¶å›¾-ç”¨æˆ·å¤è´­ç‡">æŸ±çŠ¶å›¾-ç”¨æˆ·å¤è´­ç‡</h5>
<pre><code class="language-python">repurchase_users = user_type[user_type['buy']&gt;=2].shape[0]  # è´­ä¹°è®°å½•è¶…è¿‡1æ¬¡çš„ç”¨æˆ·æ•°
repurchase_rate = repurchase_users/user_bought_count
print(&quot;å¤è´­ç‡:{:.2f}%&quot;.format(repurchase_rate*100))

# è¿›ä¸€æ­¥åˆ†æå¤è´­æ¬¡æ•°
sns.histplot(user_type[user_type['buy']&gt;=2]['buy']-1)
plt.show()
</code></pre>
<pre><code>å¤è´­ç‡:66.21%
</code></pre>
<figure data-type="image" tabindex="5"><img src="https://Angie-DA.github.io/post-images/1647759921854.png" alt="" loading="lazy"></figure>
<p>ç»“è®ºï¼šæ·˜å®ç”¨æˆ·å¤è´­ç‡èƒ½è¾¾åˆ°66.01%ï¼Œä½†æ˜¯è¿›ä¸€æ­¥æŸ¥çœ‹ç”¨æˆ·å¤è´­æ¬¡æ•°ï¼Œå‘ç°ç»å¤§å¤šæ•°ç”¨æˆ·å¤è´­æ¬¡æ•°å¾ˆå°‘ï¼›</p>
<p>æ¨æµ‹ï¼šæ·˜å®çš„å¸‚åœºä»½é¢ä¸€ç›´ç¨³å±…å‰åˆ—ï¼Œç”¨æˆ·é‡è¶³å¤Ÿåºå¤§ï¼Œè¶³å¤Ÿçš„ç”¨æˆ·é‡å¤è´­ä¸€æ¬¡ä¹Ÿèƒ½æé«˜å¤è´­ç‡ã€‚</p>
<p>ä¸ªäººæ€è€ƒï¼šåœ¨æ·˜å®ä¸‹æ²‰æ‰©å±•è·å–æ–°ç”¨æˆ·çš„åŒæ—¶ï¼Œä¿ƒè¿›è€ç”¨æˆ·å¤è´­æ¬¡æ•°å¢åŠ ï¼Œè¿›ä¸€æ­¥ç¨³å®šæé«˜å¤è´­ç‡åº”æ˜¯æ›´é‡è¦çš„äº‹æƒ…ã€‚è´­ä¹°ä¸€æ¬¡å¯èƒ½æ˜¯è¢«å¸ç›çš„æ ‡é¢˜ã€ç²¾ç¾çš„å›¾ç‰‡æˆ–æ˜¯è¯±äººçš„è¥é”€æ´»åŠ¨å¸å¼•ï¼Œè€Œå¤è´­å°±è¦æ±‚äº§å“è´¨é‡è¿‡å…³ã€æœåŠ¡åˆ°ä½ï¼Œæ¶ˆè´¹è€…å¯¹ç¬¬ä¸€æ¬¡çš„è´­ç‰©ä½“éªŒå¾ˆæ»¡æ„æ‰ä¼šè¿›è¡Œç¬¬äºŒæ¬¡,æ‰€ä»¥æ·˜å®å¯ä»¥é‡ç‚¹åœ¨è¿™äº›æ–¹é¢å¸®åŠ©å•†å®¶ã€‚</p>
<h5 id="åŠ¨æ€æŸ±çŠ¶-ç”¨æˆ·é‡å˜åŒ–è¶‹åŠ¿">åŠ¨æ€æŸ±çŠ¶-ç”¨æˆ·é‡å˜åŒ–è¶‹åŠ¿</h5>
<p>1ã€æ¯æ—¥çš„æ´»è·ƒç”¨æˆ·é‡åŸºæœ¬åœ¨71%å·¦å³ï¼Œè€Œæˆäº¤å®¢æˆ·åŸºæœ¬ç»´æŒåœ¨20%</p>
<p>2ã€2017/12/02å’Œ2017/12/03è´­ä¹°é‡å’Œè´­ä¹°äººæ•°æ˜¯ä¸Šæ¶¨çš„ï¼Œè€Œæ´»è·ƒç”¨æˆ·æ¯”ä¾‹è¾ƒå‰ä¸‰å¤©ä¸‹é™äº†ä¸€ä¸ªç™¾åˆ†ç‚¹ï¼Œä¸”ä»˜è´¹ç”¨æˆ·å æ¯”ï¼ŒARPUã€ARPPUå‡ä¸‹é™äº†ä¸€åˆ°ä¸¤ä¸ªç™¾åˆ†ç‚¹ã€‚</p>
<p>3ã€è¿™9å¤©å†…ï¼Œç”¨æˆ·æ´»è·ƒå¤©æ•°å‘ˆç°æ­£æ€åˆ†å¸ƒï¼Œç”¨æˆ·æ´»è·ƒå¤©æ•°ä¸»è¦é›†ä¸­åœ¨3-7å¤©ï¼ˆç”¨æˆ·å½“å¤©æ“ä½œè®°å½•è¾¾3æ¡ç®—ä½œå½“å¤©æ´»è·ƒï¼‰</p>
<p>å½“æ—¥UVã€å½“æ—¥å¹³å‡è®¿é—®é‡ï¼Œå½“æ—¥äº¤æ˜“ç”¨æˆ·æ•°ã€äº¤æ˜“ç”¨æˆ·æ¯”ä¾‹(å½“æ—¥äº¤æ˜“ç”¨æˆ·æ•°/å½“æ—¥UV)ï¼Œå½“æ—¥ARPU(æ€»äº¤æ˜“é‡/å½“æ—¥UVoræ´»è·ƒç”¨æˆ·æ•°)ã€å½“æ—¥ARPPU(æ€»äº¤æ˜“é‡/å½“æ—¥äº¤æ˜“ç”¨æˆ·æ•°oræ´»è·ƒäº¤æ˜“ç”¨æˆ·é‡)ï¼Œå½“æ—¥æ´»è·ƒç”¨æˆ·æ•°(è‡ªå®šä¹‰â€œæ´»è·ƒâ€)ï¼›â€”â€”ç”¨æˆ·é‡å˜åŒ–è¶‹åŠ¿å›¾</p>
<pre><code class="language-python">behavior_types=list(dict(dataframe['type'].value_counts()).keys())
behavior_types
</code></pre>
<pre><code>['pv', 'cart', 'fav', 'buy']
</code></pre>
<pre><code class="language-python">groupby_date = dataframe.groupby(by=dataframe.date)                               # æ ¹æ®æ—¥æœŸåˆ†ç»„
dates = sorted(list(dict(dataframe['date'].value_counts()).keys()))
dates_df = pd.DataFrame(data=None, index=dates, columns=behavior_types)           # åˆ›å»ºæŒ‰æ—¥æœŸåˆ†ç»„çš„æ•°æ®æ¡†

for d in dates:
    dates_df.loc[d] = groupby_date.get_group(d).type.value_counts()               # æŒ‰æ—¥æœŸå¡«å……æ•°æ®æ¡†

# æ—¥æœŸè½¬æ¢ä¸ºæ˜ŸæœŸï¼Œdatetime.datetime.isoweekdayï¼ˆï¼‰è¿”å›çš„1-7ä»£è¡¨å‘¨ä¸€--å‘¨æ—¥
dates_df['weekday'] = [datetime.datetime.isoweekday(datetime.date(x.year,x.month,x.day)) for x in dates_df.index]
dates_df
</code></pre>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pv</th>
      <th>cart</th>
      <th>fav</th>
      <th>buy</th>
      <th>weekday</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-11-25</th>
      <td>93932</td>
      <td>5786</td>
      <td>2716</td>
      <td>1974</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2017-11-26</th>
      <td>95657</td>
      <td>5784</td>
      <td>3113</td>
      <td>2022</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2017-11-27</th>
      <td>87243</td>
      <td>5463</td>
      <td>2873</td>
      <td>2229</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2017-11-28</th>
      <td>88637</td>
      <td>5516</td>
      <td>2726</td>
      <td>2220</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2017-11-29</th>
      <td>91334</td>
      <td>5550</td>
      <td>3057</td>
      <td>2299</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2017-11-30</th>
      <td>94735</td>
      <td>5638</td>
      <td>2891</td>
      <td>2323</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2017-12-01</th>
      <td>98138</td>
      <td>6102</td>
      <td>2999</td>
      <td>2151</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2017-12-02</th>
      <td>123514</td>
      <td>7829</td>
      <td>3895</td>
      <td>2536</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2017-12-03</th>
      <td>122446</td>
      <td>7779</td>
      <td>3818</td>
      <td>2605</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
<pre><code class="language-python">dates_df['uv'] = [groupby_date.get_group(d).userid.nunique() for d in dates]  # æ¯æ—¥ç‹¬ç«‹è®¿å®¢é‡

# è‡ªå®šä¹‰å½“å¤©ä½¿ç”¨æ·˜å®appè¿›è¡Œ5æ¬¡æ“ä½œï¼ˆæ— è®ºæ˜¯æŸ¥çœ‹è¯¦æƒ…é¡µã€æ”¶è—ã€åŠ å…¥è´­ç‰©è½¦è¿˜æ˜¯è´­ä¹°éƒ½ç®—ï¼‰çš„ç”¨æˆ·å°±æ˜¯æ´»è·ƒç”¨æˆ·
active_user_standard = 3                                                      # è‡ªå®šä¹‰æ´»è·ƒç”¨æˆ·æ“ä½œæ¬¡æ•°åŸºå‡†
dates_df['dau'] = [(groupby_date.get_group(d).groupby(by='userid').size()&gt;active_user_standard).value_counts()[True] for d in dates]
dates_df['au_rate'] = dates_df['dau']/dates_df['uv']                          # æ´»è·ƒç”¨æˆ·æ¯”ä¾‹
dates_df['buyer'] = dataframe[dataframe['type']=='buy'].groupby(by=['date','userid']).size().count(level=0)
dates_df['buyer_rate'] = dates_df['buyer']/dates_df['uv']                     # ä»˜è´¹ç”¨æˆ·æ¯”ä¾‹
dates_df['ARPU'] = dates_df['buy']/dates_df['uv']                             # äººå‡è´­ä¹°é‡=æ€»äº¤æ˜“é‡/å½“æ—¥UV
dates_df['ARPPU'] = dates_df['buy']/dates_df['buyer']                         # ä»˜è´¹ç”¨æˆ·äººå‡è´­ä¹°é‡
dates_df
</code></pre>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pv</th>
      <th>cart</th>
      <th>fav</th>
      <th>buy</th>
      <th>weekday</th>
      <th>uv</th>
      <th>dau</th>
      <th>au_rate</th>
      <th>buyer</th>
      <th>buyer_rate</th>
      <th>ARPU</th>
      <th>ARPPU</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-11-25</th>
      <td>93932</td>
      <td>5786</td>
      <td>2716</td>
      <td>1974</td>
      <td>6</td>
      <td>6976</td>
      <td>5029</td>
      <td>0.720900</td>
      <td>1317</td>
      <td>0.188790</td>
      <td>0.28297</td>
      <td>1.498861</td>
    </tr>
    <tr>
      <th>2017-11-26</th>
      <td>95657</td>
      <td>5784</td>
      <td>3113</td>
      <td>2022</td>
      <td>7</td>
      <td>7128</td>
      <td>5143</td>
      <td>0.721521</td>
      <td>1324</td>
      <td>0.185746</td>
      <td>0.28367</td>
      <td>1.52719</td>
    </tr>
    <tr>
      <th>2017-11-27</th>
      <td>87243</td>
      <td>5463</td>
      <td>2873</td>
      <td>2229</td>
      <td>1</td>
      <td>7026</td>
      <td>5053</td>
      <td>0.719186</td>
      <td>1415</td>
      <td>0.201395</td>
      <td>0.31725</td>
      <td>1.575265</td>
    </tr>
    <tr>
      <th>2017-11-28</th>
      <td>88637</td>
      <td>5516</td>
      <td>2726</td>
      <td>2220</td>
      <td>2</td>
      <td>7032</td>
      <td>4965</td>
      <td>0.706058</td>
      <td>1410</td>
      <td>0.200512</td>
      <td>0.3157</td>
      <td>1.574468</td>
    </tr>
    <tr>
      <th>2017-11-29</th>
      <td>91334</td>
      <td>5550</td>
      <td>3057</td>
      <td>2299</td>
      <td>3</td>
      <td>7141</td>
      <td>5207</td>
      <td>0.729170</td>
      <td>1467</td>
      <td>0.205433</td>
      <td>0.321944</td>
      <td>1.567144</td>
    </tr>
    <tr>
      <th>2017-11-30</th>
      <td>94735</td>
      <td>5638</td>
      <td>2891</td>
      <td>2323</td>
      <td>4</td>
      <td>7243</td>
      <td>5226</td>
      <td>0.721524</td>
      <td>1476</td>
      <td>0.203783</td>
      <td>0.320723</td>
      <td>1.573848</td>
    </tr>
    <tr>
      <th>2017-12-01</th>
      <td>98138</td>
      <td>6102</td>
      <td>2999</td>
      <td>2151</td>
      <td>5</td>
      <td>7270</td>
      <td>5327</td>
      <td>0.732737</td>
      <td>1418</td>
      <td>0.195048</td>
      <td>0.295873</td>
      <td>1.516925</td>
    </tr>
    <tr>
      <th>2017-12-02</th>
      <td>123514</td>
      <td>7829</td>
      <td>3895</td>
      <td>2536</td>
      <td>6</td>
      <td>9567</td>
      <td>6811</td>
      <td>0.711926</td>
      <td>1726</td>
      <td>0.180412</td>
      <td>0.265078</td>
      <td>1.469293</td>
    </tr>
    <tr>
      <th>2017-12-03</th>
      <td>122446</td>
      <td>7779</td>
      <td>3818</td>
      <td>2605</td>
      <td>7</td>
      <td>9561</td>
      <td>6774</td>
      <td>0.708503</td>
      <td>1759</td>
      <td>0.183977</td>
      <td>0.272461</td>
      <td>1.480955</td>
    </tr>
  </tbody>
</table>
<pre><code class="language-python">(
    Line(init_opts=opts.InitOpts(width=&quot;800px&quot;, height=&quot;500px&quot;))
    .add_xaxis(xaxis_data=dates_df.index)
    .add_yaxis(&quot;uv&quot;, y_axis=dates_df['uv'],is_symbol_show=False)
    .add_yaxis(&quot;dau&quot;,y_axis=dates_df['dau'],is_symbol_show=False)
    .add_yaxis(&quot;buyer&quot;,y_axis=dates_df['buyer'],is_symbol_show=False)
    .set_global_opts(
        title_opts=opts.TitleOpts(title=&quot;ç”¨æˆ·é‡å˜åŒ–è¶‹åŠ¿&quot;, 
                                  subtitle=&quot;2017/11/25-2017/12/03æœŸé—´ç”¨æˆ·é‡å˜åŒ–è¶‹åŠ¿&quot;),
        tooltip_opts=opts.TooltipOpts(trigger='axis'),
        toolbox_opts=opts.ToolboxOpts(is_show=True),
        xaxis_opts=opts.AxisOpts(type_='category', boundary_gap=False))
).render_notebook()
</code></pre>
<figure data-type="image" tabindex="6"><img src="https://Angie-DA.github.io/post-images/1647759938938.png" alt="" loading="lazy"></figure>
<h5 id="ç”¨æˆ·ä»·å€¼åˆ†ærfmåˆ†ærecencyfrequencymonetary">ç”¨æˆ·ä»·å€¼åˆ†æâ€”â€”RFMåˆ†æï¼ˆRecencyï¼ŒFrequencyï¼ŒMonetaryï¼‰</h5>
<p>RFMæ¨¡å‹é€šè¿‡ä¸€ä¸ªå®¢æˆ·çš„è¿‘æœŸè´­ä¹°è¡Œä¸ºã€è´­ä¹°çš„æ€»ä½“é¢‘ç‡ä»¥åŠèŠ±äº†å¤šå°‘é’±3é¡¹æŒ‡æ ‡æ¥æè¿°è¯¥å®¢æˆ·çš„ä»·å€¼çŠ¶å†µã€‚</p>
<p>Rï¼ˆRecencyï¼‰ï¼šå®¢æˆ·æœ€è¿‘ä¸€æ¬¡äº¤æ˜“æ—¶é—´çš„é—´éš”ã€‚Rå€¼è¶Šå¤§ï¼Œè¡¨ç¤ºå®¢æˆ·äº¤æ˜“å‘ç”Ÿçš„æ—¥æœŸè¶Šä¹…ï¼Œåä¹‹åˆ™è¡¨ç¤ºå®¢æˆ·äº¤æ˜“å‘ç”Ÿçš„æ—¥æœŸè¶Šè¿‘ã€‚<br>
Fï¼ˆFrequencyï¼‰ï¼šå®¢æˆ·åœ¨æœ€è¿‘ä¸€æ®µæ—¶é—´å†…äº¤æ˜“çš„æ¬¡æ•°ã€‚Få€¼è¶Šå¤§ï¼Œè¡¨ç¤ºå®¢æˆ·äº¤æ˜“è¶Šé¢‘ç¹ï¼Œåä¹‹åˆ™è¡¨ç¤ºå®¢æˆ·äº¤æ˜“ä¸å¤Ÿæ´»è·ƒã€‚<br>
Mï¼ˆMonetaryï¼‰ï¼šå®¢æˆ·åœ¨æœ€è¿‘ä¸€æ®µæ—¶é—´å†…äº¤æ˜“çš„é‡‘é¢ã€‚Må€¼è¶Šå¤§ï¼Œè¡¨ç¤ºå®¢æˆ·ä»·å€¼è¶Šé«˜ï¼Œåä¹‹åˆ™è¡¨ç¤ºå®¢æˆ·ä»·å€¼è¶Šä½ã€‚</p>
<p>æœ¬æ¬¡åˆ†ææ•°æ®é›†ä¸å«é‡‘é¢ï¼Œå› æ­¤ä»…ä»Rã€Fä¸¤ä¸ªç»´åº¦è¿›è¡Œåˆ†æ</p>
<pre><code class="language-python"># R:Recencyæœ€è¿‘ä¸€æ¬¡äº¤æ˜“æ—¥æœŸé—´éš”ï¼›F:Frequencyé¢‘ç‡ï¼Œäº¤æ˜“æ¬¡æ•°
groupby_buy_userid = dataframe[dataframe['type']=='buy'].groupby(by='userid')
# å…ˆåˆ›å»ºä¸€ä¸ªç©ºçš„DataFrame
RF = pd.DataFrame(index=groupby_buy_userid.groups.keys(), columns=['R', 'F'])

RF['F'] = groupby_buy_userid.type.count()
RF['last_buy_time'] = groupby_buy_userid.time.max()
# å‡è®¾è·å–æ•°æ®é›†çš„ç¬¬äºŒå¤©è¿›è¡Œåˆ†æï¼Œæ‰€ä»¥é€‰æ‹©2017/12/04ä¸ºå¯¹ç…§æ—¥æœŸï¼Œä¿ç•™å¤©æ•°
RF['R'] = (pd.to_datetime('2017-12-04')-RF['last_buy_time']).dt.days
</code></pre>
<pre><code class="language-python"># æœ€è¿‘çš„ä¸€æ¬¡äº¤æ˜“è®°å½•è·ç¦»2017/12/04ä¸º0å¤©
# å³12/03è´­ä¹°ç›¸å·®è¿˜ä¸åˆ°ä¸€å¤©ï¼Œæœ€è¿œçš„ä¸º9å¤©ï¼Œå¹³å‡ä¸º2.53å¤©
# Råˆ’åˆ†4ä¸ªåŒºåŸŸ 0-1,2-3,4-6,7-9,åˆ†åˆ«å¾—åˆ†4ï¼Œ3ï¼Œ2ï¼Œ1

# äº¤æ˜“æ¬¡æ•°æœ€å°‘ä¸º1æ¬¡æœ€å¤šä¸º93æ¬¡,å¹³å‡3æ¬¡
# è¿™é‡Œçš„3æ¬¡åˆ†æ¯æ˜¯æ‰€æœ‰è´­ä¹°è¿‡å•†å“çš„ç”¨æˆ·
# è€Œä¹‹å‰å¾—å‡ºçš„äººå‡è´­ä¹°æ¬¡æ•°2æ¬¡åˆ†æ¯æ˜¯æ‰€æœ‰ç”¨æˆ·
# Fåˆ’åˆ†4ä¸ªåŒºåŸŸ 1,2,3,4+ï¼Œåˆ†åˆ«å¾—åˆ†1ï¼Œ2ï¼Œ3ï¼Œ4

RF[['R','F']].describe()
</code></pre>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>6689.000000</td>
      <td>6689.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.524144</td>
      <td>3.043654</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.397553</td>
      <td>3.250811</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.000000</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>8.000000</td>
      <td>72.000000</td>
    </tr>
  </tbody>
</table>
<pre><code class="language-python">def R_score(x):
    if 0 &lt;= x &lt;= 1:
        return 4
    elif 2 &lt;= x &lt;= 3:
        return 3
    elif 4 &lt;= x &lt;= 6:
        return 2
    elif 7 &lt;= x &lt;= 9:
        return 1
    else:
        return 0


def F_score(x):
    if x == 1:
        return 1
    elif x == 2:
        return 2
    elif x == 3:
        return 3
    elif x &gt;= 4:
        return 4
    else:
        return 0


# æ ¹æ®R,Fè¿›è¡Œè¯„åˆ†
RF['R_score'] = RF.R.map(R_score)
RF['F_score'] = RF.F.map(F_score)
</code></pre>
<pre><code class="language-python">RF['R&gt;mean?']=(RF['R_score']&gt;RF['R_score'].mean())*1
RF['F&gt;mean?']=(RF['F_score']&gt;RF['F_score'].mean())*1
</code></pre>
<pre><code class="language-python">def user_classfication(tup):
    R_score, F_score = tup
    if R_score == 0 and F_score == 1:
        return &quot;é‡è¦ä¿æŒå®¢æˆ·&quot;
    elif R_score == 1 and F_score == 0:
        return &quot;é‡è¦å‘å±•å®¢æˆ·&quot;
    elif R_score == 1 and F_score == 1:
        return &quot;é‡è¦ä»·å€¼å®¢æˆ·&quot;
    elif R_score == 0 and F_score == 0:
        return &quot;é‡è¦æŒ½ç•™å®¢æˆ·&quot;
    else:
        return None
    
RF['user_classification'] = RF[['R&gt;mean?','F&gt;mean?']].apply(user_classfication, axis=1)
RF.head()
</code></pre>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R</th>
      <th>F</th>
      <th>last_buy_time</th>
      <th>R_score</th>
      <th>F_score</th>
      <th>R&gt;mean?</th>
      <th>F&gt;mean?</th>
      <th>user_classification</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>100</th>
      <td>5</td>
      <td>8</td>
      <td>2017-11-28 09:51:17</td>
      <td>2</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>é‡è¦ä¿æŒå®¢æˆ·</td>
    </tr>
    <tr>
      <th>117</th>
      <td>5</td>
      <td>10</td>
      <td>2017-11-28 16:09:39</td>
      <td>2</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>é‡è¦ä¿æŒå®¢æˆ·</td>
    </tr>
    <tr>
      <th>119</th>
      <td>4</td>
      <td>3</td>
      <td>2017-11-29 20:43:31</td>
      <td>2</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>é‡è¦ä¿æŒå®¢æˆ·</td>
    </tr>
    <tr>
      <th>121</th>
      <td>8</td>
      <td>1</td>
      <td>2017-11-25 22:17:35</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>é‡è¦æŒ½ç•™å®¢æˆ·</td>
    </tr>
    <tr>
      <th>122</th>
      <td>1</td>
      <td>3</td>
      <td>2017-12-02 13:59:07</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>é‡è¦ä»·å€¼å®¢æˆ·</td>
    </tr>
  </tbody>
</table>
<pre><code class="language-python"># ç»Ÿè®¡ç”¨æˆ·åˆ†ç±»æƒ…å†µ
RF.user_classification.value_counts()
</code></pre>
<pre><code>é‡è¦æŒ½ç•™å®¢æˆ·    2465
é‡è¦ä»·å€¼å®¢æˆ·    1667
é‡è¦å‘å±•å®¢æˆ·    1369
é‡è¦ä¿æŒå®¢æˆ·    1188
Name: user_classification, dtype: int64
</code></pre>
<pre><code class="language-python"># ç”¨æˆ·åˆ†ç±»å æ¯”
RF.user_classification.value_counts(1)
</code></pre>
<pre><code>é‡è¦æŒ½ç•™å®¢æˆ·    0.368515
é‡è¦ä»·å€¼å®¢æˆ·    0.249215
é‡è¦å‘å±•å®¢æˆ·    0.204664
é‡è¦ä¿æŒå®¢æˆ·    0.177605
Name: user_classification, dtype: float64
</code></pre>
<p>æ ¹æ®RFMæ¨¡å‹å¯¹ç”¨æˆ·åˆ†ç±»åå‘ç°é‡è¦æŒ½ç•™å®¢æˆ·æ¯”ä¾‹æœ€é«˜ï¼Œå…¶æ¬¡æ˜¯é‡è¦ä»·å€¼ç”¨æˆ·ï¼Œæ·˜å®ä½œä¸ºæˆç†Ÿçš„ç”µå­å•†åŠ¡å¹³å°ï¼Œé‡è¦ä»·å€¼å®¢æˆ·è¾¾åˆ°äº†ä¸€å®šçš„æ¯”ä¾‹ï¼Œåœ¨å…¶ä»–ç”µå•†å¹³å°ç›¸ç»§å‘å±•çš„å¤§ç¯å¢ƒä¸‹ï¼Œæ·˜å®åº”è¯¥æ³¨é‡é‡è¦æŒ½ç•™å®¢æˆ·ï¼Œä½†æ˜¯æ·˜å®ç›®å‰æ˜¯ä¸­å›½æœ€å—æ¬¢è¿çš„ç”µå•†å¹³å°ï¼Œç›®å‰åªè¦ä¿è¯å£ç¢‘ï¼Œé€‚å½“è¥é”€å¹¶æ¨å‡ºä¸€ç³»åˆ—çš„æ´»åŠ¨å°±èƒ½ç¨³å›ºéƒ¨åˆ†é‡è¦æŒ½ç•™å®¢æˆ·ï¼ŒåŒæ—¶ï¼Œéœ€è¦æé«˜ç¤¾ç¾¤ç®¡ç†çš„æ•ˆç‡ï¼Œå°†é‡è¦ä¿æŒå®¢æˆ·å’Œé‡è¦å‘å±•å®¢æˆ·è½¬å˜ä¸ºé‡è¦ä»·å€¼å®¢æˆ·ï¼Œå¯é‡‡å–å®šæœŸå‘é€æ–‡æ¡ˆã€èµ é€ä¼˜æƒ åˆ¸ç­‰æ–¹å¼ã€‚è¦æŠ“ä½ç”¨æˆ·æ¸´æœ›è¢«è®¤åŒã€æå‡ä¼˜è¶Šæ„Ÿã€çˆ±å ä¾¿å®œç­‰å¿ƒç†è¿›è¡Œè€ƒè™‘ã€‚</p>
<h5 id="ç®±å‹å›¾-ç”¨æˆ·æ¶ˆè´¹ä¹ æƒ¯åˆ†æ">ç®±å‹å›¾-ç”¨æˆ·æ¶ˆè´¹ä¹ æƒ¯åˆ†æ</h5>
<pre><code class="language-python"># ç”¨æˆ·ä¹ æƒ¯æ¶ˆè´¹æ—¶é—´ç‚¹åˆ†æ
data_user_buy=dataframe[dataframe.type=='buy']

from pyecharts import options as opts
from pyecharts.charts import Boxplot
df = pd.DataFrame(data_user_buy['hour'])
df.plot.box(title=&quot;ç”¨æˆ·ä¸‹å•æ—¶é—´&quot;)
plt.grid(linestyle=&quot;--&quot;)
plt.show()
</code></pre>
<figure data-type="image" tabindex="7"><img src="https://Angie-DA.github.io/post-images/1647759950839.png" alt="" loading="lazy"></figure>
<p>ä¸ªäººæ€è€ƒï¼šå¯¹äº§ç”Ÿè¿‡è´­ä¹°è¡Œä¸ºçš„ç”¨æˆ·åˆ†ææ¶ˆè´¹æ—¶é—´å¯çŸ¥ï¼Œä¸‹å•æ¬¡æ•°æœ€å¤šæœ€å¯†é›†çš„æ—¶é—´ç‚¹åˆ†å¸ƒåœ¨11-19ç‚¹ä¹‹é—´ï¼Œä¸­åˆå’Œä¸‹åˆç”¨æˆ·æœ€ä¹ æƒ¯äº§ç”Ÿæ¶ˆè´¹ã€‚ä¸ºäº†ä¿ƒè¿›æ¶ˆè´¹é‡ï¼Œå•†å®¶å¯ä»¥åœ¨æ­¤æ—¶é—´ç‚¹å¼€å§‹ä¿ƒé”€æ´»åŠ¨ã€‚</p>
<h3 id="å•†å“æ•°æ®åˆ†æ">å•†å“æ•°æ®åˆ†æ</h3>
<h4 id="æ¡å½¢å›¾-çƒ­é—¨å•†å“åˆ†æ">æ¡å½¢å›¾-çƒ­é—¨å•†å“åˆ†æ</h4>
<p>åˆ†åˆ«å¯¹ç‚¹å‡»é‡ã€æ”¶è—é‡ã€åŠ è´­é‡å’Œè´­ä¹°é‡å‰åçš„å•†å“å¤§ç±»è¿›è¡Œåˆ†æã€‚</p>
<pre><code class="language-python">matplotlib.use('Qt5Agg')
import matplotlib.pyplot as plt

groupby_itemid = dataframe.groupby(by='itemid')                               # æŒ‰å•†å“åˆ†ç»„
item_type_df = groupby_itemid.type.value_counts().unstack()                   # å±•å¼€ä¸ºä¸€ä¸ªdataframe
item_type_df.replace(to_replace=np.nan, value=0, inplace=True)                # ç¼ºå¤±å€¼è¡¥0

item_pv_df = item_type_df.sort_values(by='pv', ascending=False)              # æŒ‰æµè§ˆé‡é™åºæ’åˆ—
item_cart_df = item_type_df.sort_values(by='cart', ascending=False)          # æŒ‰åŠ è´­é‡é™åºæ’åˆ—
item_fav_df = item_type_df.sort_values(by='fav', ascending=False)            # æŒ‰æ”¶è—é‡é™åºæ’åˆ—
item_buy_df = item_type_df.sort_values(by='buy', ascending=False)            # æŒ‰è´­ä¹°é‡é™åºæ’åˆ—


</code></pre>
<pre><code class="language-python">item_pv_df = item_pv_df.head(10)

plt.barh(range(10),item_pv_df['pv'], tick_label=item_pv_df.index)
plt.ylabel('itemid')
plt.xlabel('pv')
plt.title('ç‚¹å‡»é‡å‰åçš„å•†å“')
plt.show()
</code></pre>
<figure data-type="image" tabindex="8"><img src="https://Angie-DA.github.io/post-images/1647759969231.png" alt="" loading="lazy"></figure>
<pre><code class="language-python">item_cart_df = item_cart_df.head(10)

plt.barh(range(10),item_cart_df['cart'], tick_label=item_cart_df.index)
plt.ylabel('itemid')
plt.xlabel('cart')
plt.title('åŠ è´­é‡å‰åçš„å•†å“')
plt.show()
</code></pre>
<figure data-type="image" tabindex="9"><img src="https://Angie-DA.github.io/post-images/1647759992631.png" alt="" loading="lazy"></figure>
<pre><code class="language-python">item_fav_df = item_fav_df.head(10)

plt.barh(range(10),item_fav_df['fav'], tick_label=item_fav_df.index)
plt.ylabel('itemid')
plt.xlabel('fav')
plt.title('æ”¶è—é‡å‰åçš„å•†å“')
plt.show()
</code></pre>
<figure data-type="image" tabindex="10"><img src="https://Angie-DA.github.io/post-images/1647760014292.png" alt="" loading="lazy"></figure>
<pre><code class="language-python">item_buy_df = item_buy_df.head(10)

plt.barh(range(10),item_buy_df['buy'], tick_label=item_buy_df.index)
plt.ylabel('itemid')
plt.xlabel('buy')
plt.title('è´­ä¹°é‡å‰åçš„å•†å“')
plt.show()
</code></pre>
<figure data-type="image" tabindex="11"><img src="https://Angie-DA.github.io/post-images/1647760030039.png" alt="" loading="lazy"></figure>
<h4 id="éŸ¦æ©å›¾-çƒ­é—¨å•†å“åˆ†æ">éŸ¦æ©å›¾-çƒ­é—¨å•†å“åˆ†æ</h4>
<pre><code class="language-python">#æ·»åŠ pyvennè·¯å¾„
import sys
sys.path.append(r'path\pyvenn-master')
import venn
labels = venn.get_labels([set(item_pv_df.index), 
                          set(item_cart_df.index), 
                          set(item_fav_df.index), 
                          set(item_buy_df.index)], 
                         fill=['number', 'percent']
                         )

fig, ax = venn.venn4(labels, names=['pv','cart','fav','buy'])
plt.title('éŸ¦æ©å›¾')
fig.show()
</code></pre>
<figure data-type="image" tabindex="12"><img src="https://Angie-DA.github.io/post-images/1647760042704.png" alt="" loading="lazy"></figure>
<p>ä¸ªäººæ€è€ƒï¼šæ ¹æ®æ¡å½¢å›¾å¯ä»¥çœ‹å‡ºç‚¹å‡»é‡ã€æ”¶è—é‡ã€åŠ è´­é‡å’Œè´­ä¹°é‡å‰å‡ åè¾ƒåå‡ åå·®è·ä¸å¤§ï¼Œè¯´æ˜æ²¡æœ‰çˆ†æ¬¾çš„å‡ºç°ã€‚</p>
<p>æ ¹æ®å››è€…éŸ¦æ©å›¾å¯ä»¥çœ‹å‡ºï¼Œè´­ä¹°é‡å‰åå“ç±»ä¸å…¶ä»–ä¸‰è€…çš„é‡åˆåº¦å´æ²¡æœ‰é‚£ä¹ˆé«˜ï¼Œè¯´æ˜å¯¹äºéƒ¨åˆ†å“ç±»å•†å“è€Œè¨€ï¼Œè™½ç„¶èƒ½å¸å¼•è®¸å¤šç”¨æˆ·ï¼Œä½†æ˜¯è´­ä¹°è½¬åŒ–ç‡å´ç›¸å¯¹è¾ƒä½ï¼Œè¿™éƒ¨åˆ†äº§å“çš„è½¬åŒ–ç‡æœ‰æå‡ç©ºé—´ã€‚</p>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li>
<ul>
<li>
<ul>
<li><a href="#%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96">æ•°æ®è¯»å–</a>
<ul>
<li><a href="#%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF">æŸ¥çœ‹æ•°æ®çš„åŸºæœ¬ä¿¡æ¯</a></li>
</ul>
</li>
<li><a href="#%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97">æ•°æ®æ¸…æ´—</a>
<ul>
<li><a href="#%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E6%B2%A1%E6%9C%89%E7%A9%BA%E5%80%BC%E7%9A%84%E6%95%B0%E6%8D%AE%E7%9A%84%E4%B8%AA%E6%95%B0">æŸ¥çœ‹æ•°æ®æ²¡æœ‰ç©ºå€¼çš„æ•°æ®çš„ä¸ªæ•°</a></li>
<li><a href="#%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E7%9A%84%E5%89%8Dn%E6%9D%A1">æŸ¥çœ‹æ•°æ®çš„å‰næ¡</a></li>
<li><a href="#%E8%BD%AC%E6%8D%A2%E7%B1%BB%E5%9E%8B-%E6%88%AA%E5%8F%96%E6%95%B0%E6%8D%AE-%E9%87%8D%E6%96%B0%E6%8E%92%E5%88%97">è½¬æ¢ç±»å‹ã€æˆªå–æ•°æ®ã€é‡æ–°æ’åˆ—</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E7%BB%93%E6%9E%9C">æ•°æ®æ¸…æ´—ç»“æœ</a></li>
</ul>
</li>
<li><a href="#%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90">ç”¨æˆ·æ•°æ®åˆ†æ</a>
<ul>
<li><a href="#%E8%BE%93%E5%87%BA%E5%BD%93%E5%89%8D%E6%95%B0%E6%8D%AE%E5%90%84%E6%A0%8F%E7%9B%AE%E8%AE%A1%E6%95%B0">è¾“å‡ºå½“å‰æ•°æ®å„æ ç›®è®¡æ•°</a></li>
<li><a href="#%E7%94%A8%E6%88%B7%E5%A4%8D%E8%B4%AD%E7%8E%87">ç”¨æˆ·å¤è´­ç‡</a></li>
<li><a href="#%E5%8F%AF%E8%A7%86%E5%8C%96%E5%9B%BE%E8%A1%A8">å¯è§†åŒ–å›¾è¡¨</a>
<ul>
<li><a href="#%E9%A5%BC%E5%9B%BE-%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%8D%A0%E6%AF%94">é¥¼å›¾-ç”¨æˆ·è¡Œä¸ºå æ¯”</a></li>
<li><a href="#%E5%8A%A8%E6%80%81%E6%9B%B2%E7%BA%BF-%E6%AF%8F%E6%97%A5pv-uv">åŠ¨æ€æ›²çº¿-æ¯æ—¥pvã€uv</a></li>
<li><a href="#%E6%BC%8F%E6%96%97%E5%9B%BE-%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA">æ¼æ–—å›¾-ç”¨æˆ·è¡Œä¸º</a></li>
<li><a href="#%E6%9F%B1%E7%8A%B6%E5%9B%BE-%E7%94%A8%E6%88%B7%E5%A4%8D%E8%B4%AD%E7%8E%87">æŸ±çŠ¶å›¾-ç”¨æˆ·å¤è´­ç‡</a></li>
<li><a href="#%E5%8A%A8%E6%80%81%E6%9F%B1%E7%8A%B6-%E7%94%A8%E6%88%B7%E9%87%8F%E5%8F%98%E5%8C%96%E8%B6%8B%E5%8A%BF">åŠ¨æ€æŸ±çŠ¶-ç”¨æˆ·é‡å˜åŒ–è¶‹åŠ¿</a></li>
<li><a href="#%E7%94%A8%E6%88%B7%E4%BB%B7%E5%80%BC%E5%88%86%E6%9E%90rfm%E5%88%86%E6%9E%90recencyfrequencymonetary">ç”¨æˆ·ä»·å€¼åˆ†æâ€”â€”RFMåˆ†æï¼ˆRecencyï¼ŒFrequencyï¼ŒMonetaryï¼‰</a></li>
<li><a href="#%E7%AE%B1%E5%9E%8B%E5%9B%BE-%E7%94%A8%E6%88%B7%E6%B6%88%E8%B4%B9%E4%B9%A0%E6%83%AF%E5%88%86%E6%9E%90">ç®±å‹å›¾-ç”¨æˆ·æ¶ˆè´¹ä¹ æƒ¯åˆ†æ</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%95%86%E5%93%81%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90">å•†å“æ•°æ®åˆ†æ</a>
<ul>
<li><a href="#%E6%9D%A1%E5%BD%A2%E5%9B%BE-%E7%83%AD%E9%97%A8%E5%95%86%E5%93%81%E5%88%86%E6%9E%90">æ¡å½¢å›¾-çƒ­é—¨å•†å“åˆ†æ</a></li>
<li><a href="#%E9%9F%A6%E6%81%A9%E5%9B%BE-%E7%83%AD%E9%97%A8%E5%95%86%E5%93%81%E5%88%86%E6%9E%90">éŸ¦æ©å›¾-çƒ­é—¨å•†å“åˆ†æ</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">ä¸‹ä¸€ç¯‡</div>
            <a href="https://Angie-DA.github.io/9Dtl7YqLP/">
              <h3 class="post-title">
                Tableauå®ç°è¿é”é—¨åº—æ—¥è¥ä¸šæƒ…å†µæ•°æ®ç›‘æ§
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  
  <a class="rss" href="https://Angie-DA.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
